class n{constructor(o,e,t){if(this.map=o,this.coordinate=e,this.details=t,!o)throw new Error("Map is not initialized");if(!e)throw new Error("Coordinates are not initialized");this.map=o,this.coordinate=e,this.draw()}self=null;popup=void 0;draw(){const o=document.createElement("div"),e=this.details?.color??"#0078D7";o.innerHTML=`
		<div style="position: absolute;transform: translate(-50%, -100%);">
			<div style="width: 24px;height: 24px;background: ${e};border-radius: 50% 50% 50% 0;transform: rotate(-45deg);box-shadow: 0 0 4px rgba(0,0,0,0.3);position: relative;">
				<div style="position: absolute;top: 50%;left: 50%;width: 10px;height: 10px;background: white;border-radius: 50%;transform: translate(-50%, -50%) rotate(45deg);"></div>
			</div>
		</div>`,o.classList.add("map-marker");const t=new ymaps3.YMapMarker({coordinates:this.coordinate,onFastClick:this.onClick},o);return this.map.addChild(t),this.self=t,this}onClick=(o,e)=>{if(window.gpMapStore.popup){const{popup:p}=window.gpMapStore;let s=!1;if(p===this.popup&&(s=!0),window.gpMapStore.popupClose(),s)return}const t=this.details?.popup;let i=null;if(!t)return;if(typeof t=="function")i=t();else if(typeof t=="string"){const p=document.createElement("div");p.innerHTML=t,i=p}else typeof t=="object"&&t instanceof HTMLElement&&(i=t);if(!i)return;const r=new ymaps3.YMapMarker({coordinates:this.coordinate},i);this.map.addChild(r),window.gpMapStore.popup=this.popup=r,window.gpMapStore.popup=r};closePopup(){window.gpMapStore.popup&&(window.gpMapStore.popupClose(),window.gpMapStore.popup=this.popup=void 0)}destroy(){this.self&&(this.map.removeChild(this.self),this.self=null)}}export{n as Marker};
